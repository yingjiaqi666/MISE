<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Game Guide</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/css/style.css">
    <!-- 添加Bootstrap图标 -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css">
</head>
<body class="starry-background">
<div th:replace="~{fragments/header :: header}"></div>

<div class="container mt-5">
    <div class="row justify-content-center">
        <div class="col-md-10 col-lg-8">
            <div class="card">
                <div class="card-header text-center">
                    <h2 class="mb-0" style="color: #9370DB; font-family: 'Times New Roman', serif;">Game Guide</h2>
                </div>
                <div class="card-body text-center">
                    <!-- 视频播放器部分 -->
                    <div class="guide-video-container mb-4">
                        <video id="guideVideo" class="video-player" controls autoplay muted>
                            <source src="/video/guide.mp4" type="video/mp4">
                            Your browser does not support the video tag.
                        </video>
                        <div class="video-controls mt-3">
                            <button id="playPauseBtn" class="btn btn-sm btn-outline-primary me-2">
                                <i class="bi bi-play-fill"></i> Play
                            </button>
                            <button id="muteBtn" class="btn btn-sm btn-outline-primary me-2">
                                <i class="bi bi-volume-up-fill"></i> Mute
                            </button>
                            <button id="fullscreenBtn" class="btn btn-sm btn-outline-primary">
                                <i class="bi bi-arrows-fullscreen"></i> Fullscreen
                            </button>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <div class="card h-100">
                                <div class="card-body">
                                    <h5 class="card-title" style="color: #9370DB;">Getting Started</h5>
                                    <p class="card-text">Learn the basics of creating and playing interactive stories.</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6 mb-3">
                            <div class="card h-100">
                                <div class="card-body">
                                    <h5 class="card-title" style="color: #9370DB;">Advanced Features</h5>
                                    <p class="card-text">Discover advanced scene editing and branching options.</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="mt-4">
                        <button class="btn btn-outline-primary me-2" onclick="window.location.href='/'">
                            <i class="bi bi-house"></i> Back to Lobby
                        </button>
                        <button class="btn btn-primary" onclick="window.location.href='/story-editor'">
                            <i class="bi bi-plus-circle"></i> Start Creating
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        const video = document.getElementById('guideVideo');
        const playPauseBtn = document.getElementById('playPauseBtn');
        const muteBtn = document.getElementById('muteBtn');
        const fullscreenBtn = document.getElementById('fullscreenBtn');

        // Play/Pause按钮控制
        playPauseBtn.addEventListener('click', function () {
            if (video.paused) {
                video.play();
                playPauseBtn.innerHTML = '<i class="bi bi-pause-fill"></i> Pause';
            } else {
                video.pause();
                playPauseBtn.innerHTML = '<i class="bi bi-play-fill"></i> Play';
            }
        });

        // 静音按钮控制
        muteBtn.addEventListener('click', function () {
            video.muted = !video.muted;
            muteBtn.innerHTML = video.muted
                ? '<i class="bi bi-volume-mute-fill"></i> Unmute'
                : '<i class="bi bi-volume-up-fill"></i> Mute';
        });

        // 全屏按钮控制
        fullscreenBtn.addEventListener('click', function () {
            if (video.requestFullscreen) {
                video.requestFullscreen();
            } else if (video.mozRequestFullScreen) { /* Firefox */
                video.mozRequestFullScreen();
            } else if (video.webkitRequestFullscreen) { /* Chrome, Safari & Opera */
                video.webkitRequestFullscreen();
            } else if (video.msRequestFullscreen) { /* IE/Edge */
                video.msRequestFullscreen();
            }
        });

        // 视频状态更新按钮
        video.addEventListener('play', function () {
            playPauseBtn.innerHTML = '<i class="bi bi-pause-fill"></i> Pause';
        });

        video.addEventListener('pause', function () {
            playPauseBtn.innerHTML = '<i class="bi bi-play-fill"></i> Play';
        });

        // 可选：视频加载失败的处理
        video.addEventListener('error', function () {
            console.error('Video loading failed');
            alert('Unable to load the tutorial video. Please make sure guide.mp4 exists in the video folder.');
        });
    });
</script>

<style>
    .guide-video-container {
        border: 3px solid #C0C0C0;
        border-radius: 10px;
        padding: 20px;
        background: rgba(0, 0, 0, 0.8);
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
    }

    .video-player {
        width: 100%;
        max-width: 800px;
        border-radius: 8px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    }

    .video-controls {
        display: flex;
        justify-content: center;
        gap: 10px;
        flex-wrap: wrap;
    }

    .card {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(10px);
        transition: transform 0.3s ease;
    }

    .card:hover {
        transform: translateY(-5px);
    }

    /* 响应式设计 */
    @media (max-width: 768px) {
        .video-player {
            max-height: 300px;
        }

        .guide-video-container {
            padding: 15px;
        }
    }
</style>
</body>
</html>